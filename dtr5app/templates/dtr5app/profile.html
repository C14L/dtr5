{% extends 'dtr5app/base.html' %}

{% block title %}{{view_user.username}} - {{view_user.profile.get_age}} / {{view_user.profile.get_sex_display}} / {{view_user.profile.distance}} km{% endblock %}

{% block body_classes %}profile{% endblock %}

{% block main %}

<aside id="sidebar">
  <h2>Your subreddit matches</h2>
  {% if view_user.profile.common_subs|length == 0 %}
  <p>You don't share any subreddits with {{view_user.username}} :(</p>
  {% else %}
  <p>{{view_user.profile.common_subs|length}} subreddits subbed by both you and {{view_user.username}}.</p>
  <ul class="sr-list">
    {% for row in view_user.profile.common_subs %}
    <li>
      <a href="{% url 'sr_page' row.sr.display_name %}">{{row.sr.display_name}}</a>
      <span class="status">
        {% if row.sr.over_18 %}
        <span class="nsfw-tag">NSFW</span>
        {% endif %}
        {% if row.user_is_moderator %}
        <span class="mod-tag">moderator</span>
        {% endif %}
        {% if row.user_is_banned %}
        <span class="banned-tag">banned</span>
        {% endif %}
        {% if row.user_is_muted %}
        <span class="muted-tag">muted</span>
        {% endif %}
      </span>
    </li>
    {% endfor %}
  </ul>
  {% endif %}

  <h2>{{view_user.username}}'s favorite subreddits</h2>
  <p></p>
  <ul class="sr-list">
    {% for row in view_user.subs.all %}
    {% if row.is_favorite %}
    <li>
      <a href="{% url 'sr_page' row.sr.display_name %}">/r/{{row.sr.display_name}}</a>
      <span class="status">
        {% if row.sr.over_18 %}
        <span class="nsfw-tag">NSFW</span>
        {% endif %}
        {% if row.user_is_moderator %}
        <span class="mod-tag">moderator</span>
        {% endif %}
        {% if row.user_is_banned %}
        <span class="banned-tag">banned</span>
        {% endif %}
        {% if row.user_is_muted %}
        <span class="muted-tag">muted</span>
        {% endif %}
      </span>
    </li>
    {% endif %}
    {% endfor %}
  </ul>
</aside>

<article>

  <div class="prevnext-user-list">
    <ul>
      {% for v in user_list %}
      <li class="{% if v.username == view_user.username %}curr{% else %}not-curr{% endif %}">
        <span class="info">{{v.username}} ({{v.profile.get_age}} / {{v.profile.get_sex_display}} / {{v.profile.get_distance_in_km|floatformat:"1"}} km away)</span><a href="{% url 'profile_page' v.username %}" class="pic"><img src="{{v.pics.all.0.url}}" alt="{{v.username}}"></a>
      </li>
      {% endfor %}
    </ul>
  </div>

  <div class="user-profile">
    <div class="header">
      <h1>{{view_user.username}}</h1>
      <p class="asl">
        <span title="Western Zodiac: {{view_user.profile.get_western_zodiac_display}} - Eastern Zodiac: {{view_user.profile.get_eastern_zodiac_display}}">{{view_user.profile.get_age}}</span>
        <span title="{{view_user.profile.get_sex_display}}">{{view_user.profile.get_sex_symbol}}</span>
        <span><a href="https://www.google.com/maps/@{{view_user.profile.lat}},{{view_user.profile.lng}},11z" title="Does NOT show the exact position. The location is intentionally fuzzied by a few km/miles.">{{view_user.profile.get_distance_in_km|floatformat:"1"}} km away</a></span>
      </p>
      <p class="account">
        A redditor for {{view_user.profile.created|timesince}} and signed up here {{view_user.date_joined|timesince}} ago.
      </p>
    </div>

    <ul class="pics">
      {% for pic in view_user.pics.all %}
      <li>
        {% if pic.url %}
        <a href="{{pic.src}}" class="pic"><img src="{{pic.url}}" alt="{{view_user.username}}"></a>
        {% else %}
        <span class="no-pic"></span>
        {% endif %}
      </li>
      {% endfor %}
    </ul>

    <div class="about">
      <p>{{view_user.profile.about}}</p>
    </div>

    <div class="info">
      <table>
        <thead>
          <tr>
            <td colspan="2">
              More about <a href="{% url 'profile_page' view_user.username %}">{{view_user.username}}</a>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Western zodiac:</td>
            <td>
              <span class="zodiac western-zodiac" title="Western Zodiac: {{view_user.profile.get_western_zodiac_display}}">{{view_user.profile.get_western_zodiac_symbol}}</span>
              {{view_user.profile.get_western_zodiac_display}}
            </td>
          </tr>
          </tr>
            <td>Eastern zodiac:</td>
            <td>
              <span class="zodiac eastern-zodiac" title="Eastern Zodiac: {{view_user.profile.get_eastern_zodiac_display}}">{{view_user.profile.get_eastern_zodiac_symbol}}</span>
              {{view_user.profile.get_eastern_zodiac_display}}
            </td>
          </tr>
          <tr>
            <td>Age:</td>
            <td>{{view_user.profile.get_age}}</td>
          </tr>
          <tr>
            <td>Gender:</td>
            <td>{{view_user.profile.get_sex_display}}</td>
          </tr>
          <tr>
            <td>Distance:</td>
            <td>{{view_user.profile.get_distance_in_km|floatformat:"1"}} km from you</td>
          </tr>
          </tr>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="info">
      <table>
        <thead>
          <tr>
            <td colspan="2">
              <a href="https://www.reddit.com/user/{{view_user.username}}/">{{view_user.username}} on Reddit</a>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Link Karma:</td>
            <td>{{view_user.profile.link_karma}}</td>
          </tr>
          <tr>
            <td>Comment Karma:</td>
            <td>{{view_user.profile.comment_karma}}</td>
          </tr>
          <tr>
            <td>Watches NSFW content:</td>
            <td>{{view_user.profile.over_18|yesno:"yes,no,?"}}</td>
          </tr>
          <tr>
            <td>Has a verified Email on Reddit:</td>
            <td>{{view_user.profile.has_verified_email|yesno:"yes,no,?"}}</td>
          </tr>
          <tr>
            <td>Has Reddit Gold:</td>
            <td>{{view_user.profile.gold_creddits|yesno:"yes,no,?"}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div>
    <p class="help">All distances are approximate, because only fuzzied location data is stored to protect privacy.</p>
  </div>
</article>

{% endblock %}
