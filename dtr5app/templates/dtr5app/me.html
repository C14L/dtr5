{% extends 'dtr5app/base.html' %}

{% block title %}settings for /u/{{user.username}}{% endblock %}

{% block body_classes %}me{% endblock %}

{% block main %}
<aside id="sidebar">


</aside>

<article>

  <div class="settings-section section-search">
    <h2>search settings</h2>
    <form class="item" method="POST" action="{% url 'me_search_page' %}">
      {% csrf_token %}
      <input type="hidden" name="next" value="{% url 'me_page' %}">
      <p>
        <span>find</span>&nbsp;
        <label>
          <select name="f_sex" size="1">
            <option value="">everybody</option>
            {% for sex in sex_choices %}
              {% if sex.0 > 0 %}
                <option{% if user.profile.f_sex == sex.0 %} selected{% endif %} value="{{sex.0}}">{{sex.1}}</option>
              {% endif %}
            {% endfor %}
          </select>
        </label>&nbsp;
        <label>
          <select name="f_distance" size="1"><!-- in km -->
            <option{% if user.profile.f_distance == 20040 %} selected{% endif %}  value="20040">worldwide</option>
            <option{% if user.profile.f_distance == 300 %} selected{% endif %}  value="3000">flyable</option>
            <option{% if user.profile.f_distance == 300 %} selected{% endif %}  value="300">driveable</option>
            <option{% if user.profile.f_distance == 50 %} selected{% endif %}  value="100">not too far</option>
            <option{% if user.profile.f_distance == 15 %} selected{% endif %} value="25">close by</option>
          </select>
        </label>&nbsp;
        <label class="submit">
          <input type="submit" value="search">
        </label>
      </p>
      <p>
        <label>
          <span><b>exclude</b> people subscribed to these subreddits:</span>
          <input type="text" name="exclude_sr_li" value="" maxlength="250" size="50" placeholder="r/shitredditsays r/AdviceAnimals r/dragonsfuckingcars">
        </label>
      </p>
    </form>
    <p class="help">
      find people subscribed to the same subreddit as you.
    </p>
  </div>

  <div class="settings-section section-profile">
    <h2>profile settings</h2>
    <form class="item manual" method="POST" action="{% url 'me_manual_page' %}">
      {% csrf_token %}
      <p>
        <label class="sex">
          <span>my gender:</span>
          <select name="sex" size="1">
            {% for sex in sex_choices %}
              <option {% if user.profile.sex == sex.0 %}selected{% endif %} value="{{sex.0}}">{{sex.1}}</option>
            {% endfor %}
          </select>
        </label>
      </p>
      <p>
        <label class="dob">
          <span>my birthday:</span>
          <input type="date" name="dob" placeholder="YYYY-MM-DD" maxlength="10" value="{{user.profile.dob|date:'c'}}">
          <span class="help">never publicly shown! only used to show your age and zodiacs.</span>
        </label>
      </p>
      <div class="lookingfor">
        <span>looking for:</span>
        <span class="checkbox-list">
          <label><input type="checkbox" name="lookingfor" value="">someone to chat</label>
          <label><input type="checkbox" name="lookingfor" value="">new friends</label>
          <label><input type="checkbox" name="lookingfor" value="">hugs and nice words</label>
          <label><input type="checkbox" name="lookingfor" value="">sexy time</label>
          <label><input type="checkbox" name="lookingfor" value="">dating</label>
          <label><input type="checkbox" name="lookingfor" value="">serious dating</label>
          <label><input type="checkbox" name="lookingfor" value="">a relationship</label>
          <label><input type="checkbox" name="lookingfor" value="">marriage</label>
          <label><input type="checkbox" name="lookingfor" value="">house+car+kids... now!</label>
          <label><input type="checkbox" name="lookingfor" value="">(another) cat</label>
          <label><input type="checkbox" name="lookingfor" value="">my car keys</label>
          <label><input type="checkbox" name="lookingfor" value="">the grand unified theory</label>
          <label><input type="checkbox" name="lookingfor" value="">world peace</label>
          <label><input type="checkbox" name="lookingfor" value="">this is getting ridiculous</label>
          <label><input type="checkbox" name="lookingfor" value="">stahp!</label>
          <label><input type="checkbox" name="lookingfor" value="">just some nice person, really.</label>
        </span>
      </div>
      <p>
        <label class="submit">
          <input type="submit" value="submit">
        </label>
      </p>
    </form>
  </div>

  <div class="settings-section section-geolocation">
    <h2>update geolocation</h2>
    <form class="item" method="GET" action="{% url 'me_locate_page' %}" onsubmit="geoloc(this);return false;">
      {% csrf_token %}
      <input type="hidden" name="lat" value="">
      <input type="hidden" name="lng" value="">
      <input type="submit" value="locate">
    </form>
    <p class="help">
      your geolocation will randomly be fuzzied up to a 2 km radius. that happens right in your browser, so you exact location is never uploaded anywhere. current location: <a href="https://www.google.com/maps/@{{user.profile.lat}},{{user.profile.lng}},11z">lat={{user.profile.lat}} lng={{user.profile.lng}}</a>
    </p>
  </div>

  <div class="settings-section section-srlist">
    <h2>update subreddits</h2>
    <form method="POST" action="{% url 'me_update_page' %}">
      {% csrf_token %}
      <input type="submit" value="update">
    </form>
    <p class="help">
      fetches the list of subreddits you are subscribed to from your reddit profile. last updated {{user.profile.updated}}
    </p>
  </div>

  <div class="settings-section section-pics">
    <h2>pictures of <a href="{% url 'profile_page' username=user.username %}">{{user.username}}</a></h2>
    <div class="item pics-form">
      <form method="POST" action="{% url 'me_picture_page' %}">
        {% csrf_token %}
        <input type="text" name="pic_url" value="" placeholder="https://imgur.com/??????">
        <input type="submit" value="add picture">
      </form>
    </div>
    <div class="item pics-preview">
      {% for pic in request.user.profile.pics %}
      <div class="pic">
        <a href="{{pic.src}}"><img src="{{pic.url}}" alt=""></a>
        <form method="POST" action="{% url 'me_pic_del_page' %}">
          {% csrf_token %}
          <input type="hidden" name="pic_url" value="{{pic.url}}">
          <input type="submit" value="delete">
        </form>
      </div>
      {% endfor %}
    </div>
  </div>

  <div class="settings-section section-about">
    <h2>about <a href="{% url 'profile_page' username=user.username %}">{{user.username}}</a></h2>
    <form class="item" method="POST" action="{% url 'me_manual_page' %}">
      {% csrf_token %}
      <textarea name="about" placeholder="write about yourself. or about your favorite subreddits. or about why you like pizza and bacon. or about that bird you saw that just escaped that cat last year.">{{user.profile.about}}</textarea>
      <p><input type="submit" value="submit"></p>
    </form>
  </div>

  <div class="settings-section section-account">
    <h2>account settings</h2>
    <ul>
      <li>
        <a href="{% url 'me_like_page' %}">liked users</a>&nbsp;
        <span class="help"></span>
      </li>
      <li>
        <a href="{% url 'me_nope_page' %}">noped users</a>&nbsp;
        <span class="help"></span>
      </li>
      <li>
        <a href="{% url 'me_flag_del_page' %}">delete all my likes and nopes</a>&nbsp;
        <span class="help"></span>
      </li>
      <li>
        <a href="{% url 'me_account_del_page' %}">delete account data</a>&nbsp;
        <span class="help">deletes most account data, all pictures, 'like' votes, profile content, etc.</span>
      </li>
    </ul>
  </div>

</article>
{% endblock %}